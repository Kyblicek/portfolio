---
// src/layouts/BaseLayout.astro
import "../styles/global.css";

const {
  title = "Jakub Honzal ‚Äì Web developer",
  description = "Full-stack developer se smyslem pro design. Vytv√°≈ô√≠m p≈ôehledn√© a modern√≠ weby.",
  structuredData, // voliteln√© ‚Äì m≈Ø≈æe≈° p≈ôepsat default n√≠≈æ
  keywords = [
    "Jakub Honzal",
    "web developer",
    "full-stack v√Ωvoj√°≈ô",
    "Astro developer",
    "tvorba webov√Ωch str√°nek",
  ],
} = Astro.props;

// Absolutn√≠ URL (preferuj Astro.site v astro.config.mjs)
const base = Astro.site ?? Astro.url;
const origin = base ? (base.origin ?? base.toString().replace(/\/$/, "")) : "https://portfolio-jakubhonzal.eu";
const homepage = new URL("/", origin).toString();

// OG image ‚Äì pokud m√°≈° jen relativn√≠ path, zkus√≠me ji p≈ôev√©st na absolutn√≠
const imagePath = "/img/portfolio-picture.png";
let ogImage = imagePath;
try {
  const b = Astro.site ?? Astro.url;
  if (b) ogImage = new URL(imagePath, b).toString();
} catch {}

// üîé Default JSON-LD (m≈Ø≈æe≈° p≈ôepsat p≈ôes prop `structuredData`)
const defaultStructuredData = [
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "url": homepage,
    "name": "Jakub Honzal ‚Äì Portfolio",
    "description": description,
    "publisher": {
      "@type": "Person",
      "name": "Jakub Honzal",
      "url": homepage
    }
  },
  {
    "@context": "https://schema.org",
    "@type": "Person",
    "name": "Jakub Honzal",
    "url": homepage,
    "jobTitle": "Web developer",
    "worksFor": {
      "@type": "Organization",
      "name": "Freelance"
    }
  }
];

// fin√°ln√≠ data ‚Äì buƒè to co po≈°le str√°nka, nebo n√°≈° default
const structuredDataFinal = structuredData ?? defaultStructuredData;
---
<html lang="cs">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="keywords" content={Array.isArray(keywords) ? keywords.join(", ") : String(keywords)} />
    <meta name="author" content="Jakub Honzal" />
    <meta name="robots" content="index, follow" />
    <meta name="theme-color" content="#0F172A" />

    {/* Canonical */}
    {base && <link rel="canonical" href={homepage} />}

    {/* Open Graph */}
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:locale" content="cs_CZ" />
    <meta property="og:image" content={ogImage} />
    {base && <meta property="og:url" content={homepage} />}

    {/* Twitter */}
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage} />

    {/* ‚úÖ JSON-LD jako RAW */}
    <script
      type="application/ld+json"
      set:html={JSON.stringify(structuredDataFinal)}
    ></script>
  </head>

  <body class="min-h-screen font-body text-paper">
    {/* Global animated gradient background (same as hero) */}
    <div class="fixed inset-0 -z-10 bg-gradient-to-br from-purple/30 via-transparent to-sky/20 animate-aurora"></div>
    <slot />
  </body>
</html>
